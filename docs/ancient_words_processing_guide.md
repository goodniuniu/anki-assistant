# 古文词语卡片增强处理说明

## 📊 项目概况

**源文件**: `extracted_120/提取结果.txt`
- 原始卡片数量: 793张
- 数据来源: Anki 卡包提取 (120.apkg)

**清洗后**: `cleaned_ancient_words.txt`
- 去除HTML标签、卡片编号
- 统一格式为 Tab 分隔的两列
- 格式: `包含词语的句子	词语释义`

**增强后**: `ancient_words_793_enhanced.txt` (正在生成)
- 使用 AI 对每张卡片进行深度增强
- 预计完成时间: 约2小时

## 🔄 处理流程

### 1. 数据清洗 ✅
```
提取结果.txt → clean_extracted_data.py → cleaned_ancient_words.txt
```

清洗内容：
- 移除卡片编号（"卡片 1:" 等）
- 移除 HTML 标签（<b>、</b>、<div>、<br>等）
- 提取句子和释义
- 统一格式为 Tab 分隔

### 2. AI 内容增强 🔄
```
cleaned_ancient_words.txt → anki_enhancer.py → ancient_words_793_enhanced.txt
```

使用 Profile: `ancient_word_enhancement`

增强内容包括：
- **【词语】**: 从句子中识别关键词语
- **【句子】**: 保持原句
- **【释义】**: 扩展和详细解释原有释义
- **【出处】**: 识别作品名称、作者、朝代
- **【词性与用法】**: 说明词性和语法功能
- **【例句】**: 提供1-2个经典例句
- **【记忆要点】**: 记忆技巧、同义词、古今对比

### 3. 导入 Anki ⏳
```
ancient_words_793_enhanced.txt → Anki → 复习卡片
```

## 📈 进度监控

当前处理状态：
- 📁 总卡片数: 792张
- ✅ 已完成: 10+ 张（包括测试）
- ⏳ 剩余: 780+ 张
- ⚡ 处理速度: 约8-9秒/张
- ⏰ 预计完成: 约2小时
- 💾 自动保存: 每10张保存一次

### 检查进度

由于处理在后台运行，你可以通过以下方式检查进度：

**方法1: 查看缓存文件**
```bash
# 查看已完成的数量
wc -l progress_cache.csv
```

**方法2: 查看输出文件**
```bash
# 查看已生成的卡片数量
wc -l ancient_words_793_enhanced.txt
```

## 🎯 增强效果示例

### 原始卡片
```
正面: 秦爱纷奢，人亦念其家
背面: 喜欢，爱好
```

### 增强后卡片
```
正面: 秦爱纷奢，人亦念其家

背面:
【词语】
爱

【句子】
秦爱纷奢，人亦念其家

【释义】
表示喜爱、偏好，带有强烈的情感倾向。此处特指统治者对奢侈生活的热衷追求，暗含贬义色彩。

【出处】
杜牧《阿房宫赋》（唐代），此句批判秦始皇穷奢极欲，同时对比百姓对家庭的眷念。

【词性与用法】
动词，作谓语。古汉语中常接宾语表示喜爱的对象（纷奢：繁华奢侈），现代汉语保留此用法但情感色彩更中性。

【例句】
1. 晋陶渊明独爱菊（《爱莲说》周敦颐）——强调个人高雅志趣
2. 父母之爱子，则为之计深远（《战国策》）——表深切关怀

【记忆要点】
• 对比记忆："爱"与"好（hào）"同义，但"爱"情感更强烈
• 古今差异：古代可表过度偏爱（如本例），现代多用于积极语境
• 字形联想："爫"（爪）+ "冖"（覆盖）+ "友"→ 用手保护所珍视之物
```

## 📁 文件说明

### 输入文件
- `提取结果.txt` - 原始提取数据（793张）
- `cleaned_ancient_words.txt` - 清洗后的数据（792张）

### 处理文件
- `clean_extracted_data.py` - 数据清洗脚本
- `anki_enhancer.py` - AI 增强主程序（v4.0）
- `config.json` - 配置文件（包含 ancient_word_enhancement Profile）

### 输出文件
- `ancient_words_793_enhanced.txt` - 最终增强卡片（正在生成）
- `progress_cache.csv` - 进度缓存文件（支持断点续传）
- `anki_process.log` - 处理日志

### 测试文件
- `test_ancient_words_sample.txt` - 测试样本（10张）
- `test_ancient_words_enhanced.txt` - 测试增强结果

## ⚠️ 注意事项

1. **中断恢复**: 如果处理中断，重新运行相同命令会自动从断点继续
2. **API 限制**: 已设置1秒延迟，避免触发API速率限制
3. **文件编码**: 所有文件使用 UTF-8 编码，导入 Anki 时请选择正确编码
4. **耗时较长**: 792张卡片预计需要约2小时，建议在空闲时运行

## 🚀 导入 Anki 步骤

处理完成后：

1. **打开 Anki**
2. **文件 → 导入**
3. **选择文件**: `ancient_words_793_enhanced.txt`
4. **选择模型**: 建议使用"基础（及反面反转）"模型
5. **字段映射**:
   - Front → Front（正面）
   - Back → Back（背面）
6. **编码选择**: UTF-8
7. **导入**: 点击导入按钮

## 📊 数据统计

### 按词语分类（部分）
根据原始数据，主要词语类型：
- 实词动词（爱、使、从、当...）
- 形容词（安、远、大、小...）
- 名词（兵、病、朝、道...）
- 虚词（曾、之、而、其...）
- 通假字（被→披、倍→背、...）

### 涵盖古籍（预计）
- 《论语》
- 《孟子》
- 《史记》
- 《左传》
- 《战国策》
- 《阿房宫赋》
- 《师说》
- 《赤壁赋》
- 等等...

## 💡 使用建议

1. **复习策略**:
   - 正面：包含词语的句子
   - 背面：先尝试回忆释义，再查看详细解释
   - 重点关注【出处】和【记忆要点】

2. **学习步骤**:
   - 第一遍：理解词语在句中的含义
   - 第二遍：记忆出处和相关例句
   - 第三遍：掌握词性和用法

3. **关联学习**:
   - 注意同义词的古今差异
   - 积累经典例句中的文化背景
   - 对比不同作品中同一词语的用法

## 🔧 技术细节

### AI 配置
- **服务商**: 七牛云 AI (DeepSeek-V3)
- **模型**: deepseek-v3
- **延迟**: 1秒/请求
- **重试**: 最多3次
- **保存间隔**: 每10张

### Profile 配置
```json
{
  "system_prompt": "你是一位资深的古汉语教学专家...",
  "user_prompt_template": "请阅读并增强以下古文词语学习卡片..."
}
```

## 📞 支持与反馈

如遇到问题：
1. 检查 `anki_process.log` 日志文件
2. 查看 `progress_cache.csv` 了解当前进度
3. 重新运行命令会自动从断点继续

## ✨ 总结

通过这个自动化流程，793张简单的古文词语卡片被升级为：
- ✅ 详细的词语解释
- ✅ 准确的出处信息
- ✅ 专业的语法分析
- ✅ 丰富的经典例句
- ✅ 实用的记忆技巧

这将大大提高古文学习的效率和质量！

---

**处理中，请耐心等待...** ⏳

生成时间: 2026-01-13
工具版本: Anki Enhancer v4.0
